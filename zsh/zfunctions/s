# zsh/zfunctions/s

#
# Tmux Session Manager
#
# Manage sessions, windows and panes in tmux
# using YAML formatted definition files.
#
# This function tries to â€¦
#  - lists all active tmux sessions if no
#    arguments are given.
#  - attaches the user to an existing tmux
#    session if the given name matches the
#    name of a session.
#  - creates a new session and loads a
#    definition file that matches the given
#    session name (requires teamocil).
#  - creates a new session with the given
#    session name.
#
# Usage: s [session_name]
#
# [$1] = Name of the session to load.
#
s() {
  local name="$1"

  # List all active sessions if no arguments are given
  if (( $# == 0 )); then
    tmux list-session -F "#{session_name} (#{t:session_last_attached})"
    return 1
  fi

  # Attach to the tmux session if it already exists
  if tmux has-session -t "$name" >/dev/null 2>&1; then
    tmux attach -t "$name"
    return 0
  fi

  # Create a new session and load an existing session
  # from a definition file using teamocil
  if teamocil --show "$name" >/dev/null 2>&1; then
    tmux new-session -s "$name" teamocil "$name"
  fi

  # Create a new tmux session with the given name
  tmux new-session -s "$name"
}

# vim:syntax=zsh
