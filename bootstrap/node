#!/usr/bin/env bash
#
# @file Install latest npm version and default packages.

set -e

readonly SCRIPT_DIR="$(dirname "$0")"
readonly DOTFILES="${DOTFILES:-$(dirname "$SCRIPT_DIR")}"

source "${DOTFILES}/shell/utilities.sh"


if ! dot::command_exists "npm"; then
  dot::exit "Cannot find npm command"
fi

dot::info "Installing latest npm version …"
npm install --global --production npm@latest

dot::info "Installing global node packages …"
npm install --global --production yo
npm install --global --production eslint

while read -r package; do
  if [[ "$package" != "yo" ]] && [[ "$package" != "eslint" ]]; then
    npm install --global --production "$package"
  fi
done < "${DOTFILES}/misc/default-node-packages"
