# tmux.conf                                                               ><>Â°
#
# -----------------------------------------------------------------------
# Table of Contents
# -----------------------------------------------------------------------
# 1. Environment settings
# 2. Display settings
# 3. Mouse support
# 4. Keybindings
# 5. System clipboard
# 6. Statusline
# 7. Tmux Plugin Manager
# -----------------------------------------------------------------------


# (1) Environment settings ---------------------------------------------- {{{1

# Enable focus events for terminals that support them
set-option -g focus-events on

# Increase scrollback buffer size (default: 2000)
set-option -g history-limit 10000

# Run tmux in vi mode
set-option -g @shell_mode 'vi'

# Improve color support
set-option -sa terminal-overrides ",*-256col*:Tc"


# (2) Display settings -------------------------------------------------- {{{1

# Customize the window titles
set-option -g set-titles on
set-option -g set-titles-string "#{pane_index}:#{window_name} in #{session_name} on #{host}"

# By default windows are limited to the size of the smallest client
set-option -g aggressive-resize on

# Check for activity in the current window
set-option -g visual-activity off
set-window-option -g monitor-activity on

# Start counting from 1
set-option -g base-index 1
set-window-option -g pane-base-index 1

# Update window index and avoid gaps
set-option -g renumber-windows on


# (3) Mouse support ----------------------------------------------------- {{{1

# Enable the mouse. Shame on me...
set-option -g mouse on

# Improve mouse wheel behavior (@see <https://git.io/vFMDd>)
bind-key -n WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'select-pane -t=; copy-mode -e; send-keys -M'"

# Select pane with a click on the scroll wheel
bind-key -n WheelDownPane select-pane -t= \; send-keys -M


# (4) Keybindings ------------------------------------------------------- {{{1

# Eliminate the delay when switching vim modes (default: 500)
set-option -s escape-time 0

# Change tmux prefix to Ctrl+Space
set-option -g prefix C-space

# Pressing `prefix + prefix` sends <prefix> to the shell
bind-key C-Space send-prefix

# Switch easily between windows
bind-key Space last-window

# Split the current pane vertically/horizontally
bind-key v split-window -h
bind-key s split-window -v

# Navigate between panes
bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

# Resize the currently active pane
bind-key H resize-pane -L 4
bind-key J resize-pane -D 4
bind-key K resize-pane -U 4
bind-key L resize-pane -R 4

# Start new windows in the directory of the current pane
bind-key c new-window -c "#{pane_current_path}"

# Reload configuration
bind-key r source-file "${XDG_CONFIG_HOME}/tmux/tmux.conf" \; display-message "Sourced tmux configuration file"

# Bring back clear-screen/kill-line under tmux prefix
bind-key C-l send "C-l"
bind-key C-k send "C-k"


# (5) System clipboard -------------------------------------------------- {{{1

# Set default command used for new windows. Fixes the clipboard on macOS.
if-shell "type reattach-to-user-namespace >/dev/null 2>&1" \
  "set-option -g default-command 'reattach-to-user-namespace -l ${SHELL}'" \
  "set-option -g default-command ${SHELL}"


# (6) Statusline -------------------------------------------------------- {{{1

# Move the status line to the top
set-option -g status-position top

# Assign custom contents to the statusline columns
set-option -g status-left " "
set-option -g status-right " #{prefix_highlight} #[fg=colour254]#{session_name}#[fg=default] "

# Customize the colors of the status line
set-option -g status-fg colour246
set-option -g status-bg brightwhite

# Customize the message line
set-option -g message-fg white
set-option -g message-bg blue

# Customize the pane borders
set-option -g pane-border-fg colour252
set-option -g pane-border-bg white
set-option -g pane-active-border-fg brightblue
set-option -g pane-active-border-bg white

# Customize the copy mode indicator
set-window-option -g mode-fg white
set-window-option -g mode-bg blue

# Customize the title of the individual windows
set-window-option -g window-status-format " #[fg=colour254]\[#{?window_last_flag,-,#{window_index}}\]#[fg=default] #{window_name} "
set-window-option -g window-status-current-format " #[fg=colour252]\[#{?window_active,*,#{window_index}}\]#[fg=default] #{window_name} "
set-window-option -g window-status-current-fg black
set-window-option -g window-status-current-bg white


# (7) Tmux Plugin Manager ----------------------------------------------- {{{1

# Customize the target destination of plugins installed via tpm
set-environment -g TMUX_PLUGIN_MANAGER_PATH "${XDG_DATA_HOME}/tmux/plugins"

# Select a list of plugins to install via the plugin manager
set-option -g @tpm_plugins 'tmux-plugins/tpm tmux-plugins/tmux-prefix-highlight tmux-plugins/tmux-yank'

# Install the plugin manager if it is not already installed
if-shell "[[ ! -d ${XDG_DATA_HOME}/tmux/plugins/tpm ]]" \
  "run-shell 'git clone https://github.com/tmux-plugins/tpm ${XDG_DATA_HOME}/tmux/plugins/tpm && ${XDG_DATA_HOME}/tmux/plugins/tpm/bin/install_plugins'"

# Load the plugins into the current environment
run-shell "${XDG_DATA_HOME}/tmux/plugins/tpm/tpm"


# vim:foldmethod=marker:foldlevel=1
